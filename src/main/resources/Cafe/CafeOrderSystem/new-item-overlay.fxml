<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<StackPane xmlns="http://javafx.com/javafx/21"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="Cafe.CafeOrderSystem.UI.NewItemController">
    <!-- Dim background -->
    <Pane style="-fx-background-color: rgba(0,0,0,0.45);" />

    <!-- Card -->
    <BorderPane maxWidth="820" prefWidth="780" maxHeight="640"
                style="-fx-background-color: white; -fx-background-radius: 14; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 20, 0.2, 0, 6);">
        <padding>
            <Insets top="18" right="18" bottom="18" left="18"/>
        </padding>

        <!-- Header -->
        <top>
            <VBox spacing="6">
                <Label text="Create New Item">
                    <font>
                        <Font name="System Bold" size="20"/>
                    </font>
                </Label>
                <Label text="Use the tabs to switch item type." />
            </VBox>
        </top>

        <!-- Body -->
        <center>
            <TabPane fx:id="typeTabPane" tabClosingPolicy="UNAVAILABLE" prefHeight="520">
                <!-- INGREDIENT TAB -->
                <Tab fx:id="ingredientTab" text="Ingredient" closable="false">
                    <content>
                        <TabPane fx:id="ingredientInnerTabs" tabClosingPolicy="UNAVAILABLE">
                            <!-- Details -->
                            <Tab fx:id="ingredientDetailsTab" text="Details" closable="false">
                                <content>
                                    <GridPane hgap="14" vgap="12">
                                        <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
                                        <columnConstraints>
                                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                                            <ColumnConstraints hgrow="ALWAYS"/>
                                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                                            <ColumnConstraints hgrow="SOMETIMES"/>
                                        </columnConstraints>

                                        <!-- Name -->
                                        <Label text="Name" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                                        <TextField fx:id="ingredientNameField" promptText="e.g., Espresso Beans"
                                                   GridPane.rowIndex="0" GridPane.columnIndex="1" GridPane.columnSpan="3"/>
                                    </GridPane>
                                </content>
                            </Tab>

                            <!-- Stock / Cost -->
                            <Tab fx:id="ingredientStockTab" text="Stock Cost" closable="false">
                                <content>
                                    <GridPane hgap="14" vgap="12">
                                        <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
                                        <columnConstraints>
                                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                                            <ColumnConstraints hgrow="ALWAYS"/>
                                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                                            <ColumnConstraints hgrow="SOMETIMES"/>
                                        </columnConstraints>

                                        <!-- Starting Stock (count) -->
                                        <Label text="Starting Stock" GridPane.rowIndex="0" GridPane.columnIndex="2"/>
                                        <Spinner fx:id="startingStockSpinner" editable="true"
                                                 GridPane.rowIndex="0" GridPane.columnIndex="3"/>

                                        <!-- Preview -->
                                        <Label text="Preview" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                                        <Label fx:id="ingredientPreviewLabel" text="—"
                                               GridPane.rowIndex="2" GridPane.columnIndex="1" GridPane.columnSpan="3"/>
                                    </GridPane>
                                </content>
                            </Tab>
                        </TabPane>
                    </content>
                </Tab>

                <!-- BEVERAGE TAB (stub) -->
                <Tab fx:id="beverageTab" text="Beverage" closable="false" disable="true">
                    <content>
                        <VBox>
                            <Label text="Beverage form goes here (sizes, prices, ingredients per size)." />
                        </VBox>
                    </content>
                </Tab>

                <!-- PASTRY TAB -->
                <!-- PASTRY TAB -->
            <Tab fx:id="pastryTab" text="Pastry" closable="false">
                <content>
                    <GridPane hgap="14" vgap="12">
                        <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
                        <columnConstraints>
                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                            <ColumnConstraints hgrow="ALWAYS"/>
                            <ColumnConstraints minWidth="160" halignment="RIGHT"/>
                            <ColumnConstraints hgrow="SOMETIMES"/>
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints minHeight="30"/>
                            <RowConstraints minHeight="30"/>
                            <RowConstraints minHeight="30"/>
                            <RowConstraints minHeight="200"/>
                            <RowConstraints minHeight="30"/>
                        </rowConstraints>

                        <!-- Name -->
                        <Label text="Name" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                        <TextField fx:id="pastryNameField" promptText="e.g., Croissant"
                                GridPane.rowIndex="0" GridPane.columnIndex="1" GridPane.columnSpan="3"/>

                        <!-- Price -->
                        <Label text="Price ($)" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                        <Spinner fx:id="pastryPriceSpinner" editable="true"
                            GridPane.rowIndex="1" GridPane.columnIndex="1" GridPane.halignment="LEFT">
                            <GridPane.margin>
                                <Insets left="10"/>
                            </GridPane.margin>
                        </Spinner>

                        <!-- Ingredients Selection -->
                        <Label text="Ingredients" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                        <HBox spacing="10" alignment="CENTER" GridPane.rowIndex="3" GridPane.columnIndex="0" GridPane.columnSpan="4">
                            <VBox spacing="5" prefWidth="200">
                                <Label text="Available Ingredients"/>
                                <ListView fx:id="availableIngredientsListView" prefHeight="150"/>
                            </VBox>
                            
                            <VBox spacing="10" alignment="CENTER">
                                <Label text="Quantity"/>
                                <Spinner fx:id="ingredientQuantitySpinner" prefWidth="80"/>
                                <Button fx:id="addIngredientButton" text="Add →" mnemonicParsing="false"/>
                                <Button fx:id="removeIngredientButton" text="← Remove" mnemonicParsing="false"/>
                            </VBox>
                            
                            <VBox spacing="5" prefWidth="200">
                                <Label text="Selected Ingredients"/>
                                <ListView fx:id="selectedIngredientsListView" prefHeight="150"/>
                            </VBox>
                        </HBox>

                        <!-- Preview -->
                        <Label text="Preview" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
                        <Label fx:id="pastryPreviewLabel" text="—"
                            GridPane.rowIndex="4" GridPane.columnIndex="1" GridPane.columnSpan="3"/>
                    </GridPane>
                </content>
            </Tab>
            </TabPane>
        </center>

        <!-- Footer -->
        <bottom>
            <HBox alignment="CENTER_RIGHT" spacing="10">
                <Button fx:id="cancelBtn" text="Cancel" onAction="#handleCancel"/>
                <Button fx:id="saveBtn" text="Save" onAction="#handleSave" defaultButton="true"/>
            </HBox>
        </bottom>
    </BorderPane>
</StackPane>